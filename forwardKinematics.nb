(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     69723,       1645]
NotebookOptionsPosition[     64253,       1521]
NotebookOutlinePosition[     64594,       1536]
CellTagsIndexPosition[     64551,       1533]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Definition", " ", "of", " ", "our", " ", "origin", " ", "matrix"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"g0", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "w"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
   " "}]}]], "Input",
 CellChangeTimes->{{3.721500606086858*^9, 3.721500616508023*^9}, {
   3.721500692832389*^9, 3.721500809770305*^9}, {3.721502140284615*^9, 
   3.7215021420553894`*^9}, {3.72153214626828*^9, 3.721532150112252*^9}, 
   3.7215322138407283`*^9, {3.721533575715103*^9, 3.7215335761409006`*^9}, {
   3.721583115949153*^9, 3.721583117820185*^9}, {3.721583151316925*^9, 
   3.7215831856597767`*^9}, {3.724646413705824*^9, 3.724646414103913*^9}, {
   3.7247634629542246`*^9, 
   3.7247634710408134`*^9}},ExpressionUUID->"eaf0cf27-0c46-44b8-856e-\
201e8b237385"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721501008073926*^9, 3.7215010120611877`*^9}, 
   3.7246411403142548`*^9},ExpressionUUID->"c8cabb1d-0e8d-4061-9659-\
7f7be289a460"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.721573773888918*^9, {3.7246411418775487`*^9, 
   3.724641142482709*^9}},ExpressionUUID->"b23e6e56-0074-4449-ba0c-\
7a8a41fade4b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.7215831563830495`*^9, 
  3.724641143882507*^9},ExpressionUUID->"5681b5d7-d807-4a7c-a5cb-\
3e665b03a576"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Auxillary", " ", "Functions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Creates", " ", "a", " ", "skew", " ", "symmetric", " ", "matrix", " ", 
    "from", " ", "a", " ", "vector"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"vecToSkew", "[", "V_", "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Dimensions", "[", "V", "]"}], " ", "\[Equal]", " ", 
       RowBox[{"{", "3", "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"-", 
           RowBox[{"V", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
          RowBox[{"V", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"V", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
          RowBox[{"-", 
           RowBox[{"V", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"V", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", 
          RowBox[{"V", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}], " ", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Quick", " ", "check", " ", "to", " ", "see", " ", "if", " ", "omega", 
     " ", "consists", " ", "purely", " ", "of", " ", "zero", " ", "vector"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"is0", "[", "vect_", "]"}], ":=", 
    RowBox[{"AllTrue", "[", 
     RowBox[{"vect", ",", "EvenQ"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "omega", " ", "hat", " ", "theta", " ", 
     "exponential"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"omegaHatExp", "[", 
     RowBox[{"omega_", ",", "theta_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", 
     RowBox[{
      RowBox[{"vecToSkew", "[", "omega", "]"}], "*", 
      RowBox[{"Sin", "[", "theta", "]"}]}], "+", 
     RowBox[{
      RowBox[{"MatrixPower", "[", 
       RowBox[{
        RowBox[{"vecToSkew", "[", "omega", "]"}], ",", "2"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Cos", "[", "theta", "]"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Compute", " ", "the", " ", "twist", " ", "exponential", " ", "term"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TwistExp", " ", "[", 
     RowBox[{"omega_", ",", " ", "v_", ",", " ", "theta_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"is0", "[", "omega", "]"}], ",", "\[IndentingNewLine]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", "theta"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "*", "theta"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", 
          RowBox[{
           RowBox[{"v", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "*", "theta"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"omegaHatExp", "[", 
             RowBox[{"omega", ",", "theta"}], "]"}], ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"IdentityMatrix", "[", "3", "]"}], " ", "-", " ", 
                 RowBox[{"omegaHatExp", "[", 
                  RowBox[{"omega", ",", "theta"}], "]"}]}], ")"}], ".", 
               RowBox[{"Cross", "[", 
                RowBox[{"omega", ",", " ", "v"}], "]"}]}], "}"}], "]"}]}], 
           "}"}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "We", " ", "also", " ", "define", " ", "our", " ", "twist", " ", "hats"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TwistHat", "[", 
     RowBox[{"omega_", ",", " ", "v_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vecToSkew", "[", "omega", "]"}], ",", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", "v", "}"}], "]"}]}], "}"}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.721501817678791*^9, 3.7215019296090813`*^9}, {
   3.721501986684533*^9, 3.7215020064905143`*^9}, {3.721502128926922*^9, 
   3.7215021359981127`*^9}, {3.7215022840019217`*^9, 
   3.7215023106385975`*^9}, {3.7215023984676332`*^9, 
   3.7215024062540364`*^9}, {3.7215024417895594`*^9, 
   3.7215025109257364`*^9}, {3.72150257182086*^9, 3.7215025949851522`*^9}, {
   3.721502785989666*^9, 3.72150282690816*^9}, {3.7215033860136085`*^9, 
   3.7215034060886993`*^9}, {3.7215034579764333`*^9, 
   3.7215035364143734`*^9}, {3.721503585170557*^9, 3.721503587324849*^9}, {
   3.7215036859117813`*^9, 3.7215037140644426`*^9}, {3.721503880359397*^9, 
   3.721504032885361*^9}, {3.7215041292229505`*^9, 3.721504143839181*^9}, {
   3.72150420400852*^9, 3.7215042291018543`*^9}, 3.721504364097851*^9, {
   3.7215047418349237`*^9, 3.7215047945210333`*^9}, {3.721504873978885*^9, 
   3.7215049157741404`*^9}, {3.7215049544164877`*^9, 3.721505191136695*^9}, {
   3.7215052900865526`*^9, 3.721505490944611*^9}, {3.721505580892247*^9, 
   3.7215055842712617`*^9}, {3.7215059676046095`*^9, 
   3.7215059703835692`*^9}, {3.721506084228468*^9, 3.721506100716095*^9}, {
   3.721506158894633*^9, 3.7215061776235175`*^9}, {3.7215062122460318`*^9, 
   3.7215063058606997`*^9}, {3.721506382813033*^9, 3.7215064326625595`*^9}, {
   3.721506646001966*^9, 3.721506710514124*^9}, {3.7215073548051615`*^9, 
   3.7215074301663027`*^9}, {3.721507520572051*^9, 3.721507551442468*^9}, {
   3.7215078761383963`*^9, 3.7215078900409575`*^9}, 3.7215103322242785`*^9, {
   3.7215271669069867`*^9, 3.7215271809109025`*^9}, {3.7215736963110228`*^9, 
   3.721573696533621*^9}, {3.721573769951329*^9, 3.72157379905166*^9}, {
   3.721573902840119*^9, 3.721573970738145*^9}, {3.7215743809705253`*^9, 
   3.7215744032305946`*^9}, {3.7215744788393917`*^9, 3.721574484746273*^9}, {
   3.7215745830656776`*^9, 3.7215745864708357`*^9}, {3.721574626991312*^9, 
   3.7215746455156326`*^9}, {3.7215746852701817`*^9, 3.7215747169215593`*^9}, 
   3.7216028880799804`*^9},ExpressionUUID->"0322f2ff-cde8-447b-a434-\
c71a1e53595c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Definition", " ", "of", " ", "twists"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xi1", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"Xi2", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{"l1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
     "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"Xi3", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"l1", "+", "l2"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "1"}], "}"}]}], "\[IndentingNewLine]", 
   RowBox[{"Xi4", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}],
    "\[IndentingNewLine]", 
   RowBox[{"Xi5", " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"h", "+", "l3"}], ")"}]}], ",", "0", ",", "0", ",", "0", ",", 
      "1", ",", "0"}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7215011979723897`*^9, 3.7215012026107907`*^9}, {
   3.7215014613634057`*^9, 3.7215014641373005`*^9}, {3.7215016241307964`*^9, 
   3.72150165585242*^9}, {3.721502081015591*^9, 3.721502120674004*^9}, {
   3.7215064638324294`*^9, 3.72150646444987*^9}, {3.721507716098999*^9, 
   3.7215077162791834`*^9}, {3.721510233697912*^9, 3.7215102657861633`*^9}, {
   3.721531818014671*^9, 3.7215318255176597`*^9}, {3.7215319007546773`*^9, 
   3.72153190349117*^9}, {3.7215323109195466`*^9, 3.721532325595196*^9}, {
   3.721532683370311*^9, 3.7215326911557684`*^9}, {3.721533023491576*^9, 
   3.7215330279815893`*^9}, 3.7215330955911055`*^9, {3.7215334468587894`*^9, 
   3.721533448688298*^9}},ExpressionUUID->"74472697-73d8-44dd-95ff-\
7d3b43c46981"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Definition", " ", "of", " ", "twist", " ", "exponentials"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TwistExp1", " ", ":=", 
    RowBox[{"TwistExp", "[", 
     RowBox[{
      RowBox[{"Xi1", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5", ",", "6"}], "}"}], "]"}], "]"}], ",", 
      RowBox[{"Xi1", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], ",", 
      "theta1"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp2", " ", ":=", 
    RowBox[{"TwistExp", "[", 
     RowBox[{
      RowBox[{"Xi2", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5", ",", "6"}], "}"}], "]"}], "]"}], ",", 
      RowBox[{"Xi2", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], ",", 
      "theta2"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp3", " ", ":=", 
    RowBox[{"TwistExp", "[", 
     RowBox[{
      RowBox[{"Xi3", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5", ",", "6"}], "}"}], "]"}], "]"}], ",", 
      RowBox[{"Xi3", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], ",", 
      "theta3"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp4", " ", ":=", 
    RowBox[{"TwistExp", "[", 
     RowBox[{
      RowBox[{"Xi4", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5", ",", "6"}], "}"}], "]"}], "]"}], ",", 
      RowBox[{"Xi4", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], ",", 
      "theta4"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp5", " ", ":=", 
    RowBox[{"TwistExp", "[", 
     RowBox[{
      RowBox[{"Xi5", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"4", ",", "5", ",", "6"}], "}"}], "]"}], "]"}], ",", 
      RowBox[{"Xi5", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], ",", 
      "theta5"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp1", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp2", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp3", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp4", " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"TwistExp5", " ", "//", " ", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.721501687011619*^9, 3.721501699251584*^9}, {
  3.7215017547359085`*^9, 3.7215017607025604`*^9}, {3.72150215423748*^9, 
  3.721502162560464*^9}, {3.7215021944884634`*^9, 3.721502212934929*^9}, {
  3.7215055101800327`*^9, 3.721505532491602*^9}, {3.7215067173410044`*^9, 
  3.7215067492150793`*^9}, {3.721506917587597*^9, 3.7215069203308363`*^9}, {
  3.7215069621788716`*^9, 3.721506976963563*^9}, {3.721507557114019*^9, 
  3.721507558541733*^9}, {3.721507711689124*^9, 3.7215077136710978`*^9}, {
  3.721507751414525*^9, 3.721507784652707*^9}, {3.721510125676895*^9, 
  3.721510200187405*^9}, {3.7215102723302593`*^9, 3.72151030589893*^9}, {
  3.7215319061306486`*^9, 3.721531918358611*^9}, {3.7215323307498093`*^9, 
  3.7215323349738135`*^9}, {3.721574341942093*^9, 
  3.7215743586795907`*^9}},ExpressionUUID->"56eef097-f174-43c4-839e-\
d61b6d6e6960"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "theta1", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "theta1", "]"}]}], "0", "0"},
     {
      RowBox[{"Sin", "[", "theta1", "]"}], 
      RowBox[{"Cos", "[", "theta1", "]"}], "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.721573780260047*^9, 3.7215738065628633`*^9}, 
   3.7215743436892924`*^9, 3.721574723553941*^9, 3.7215822024673047`*^9, {
   3.721583160302783*^9, 3.7215832028610864`*^9}, 
   3.721675566130268*^9},ExpressionUUID->"7e83ff24-071f-4f9a-9598-\
8cb74c1d4cbb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "theta2", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "theta2", "]"}]}], "0", 
      RowBox[{"l1", " ", 
       RowBox[{"Sin", "[", "theta2", "]"}]}]},
     {
      RowBox[{"Sin", "[", "theta2", "]"}], 
      RowBox[{"Cos", "[", "theta2", "]"}], "0", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "theta2", "]"}]}], ")"}]}]},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.721573780260047*^9, 3.7215738065628633`*^9}, 
   3.7215743436892924`*^9, 3.721574723553941*^9, 3.7215822024673047`*^9, {
   3.721583160302783*^9, 3.7215832028610864`*^9}, 
   3.7216755661327744`*^9},ExpressionUUID->"cfcb9e5d-e8b4-4d7b-99ae-\
f129172b6e4b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "theta3", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "theta3", "]"}]}], "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l1", "+", "l2"}], ")"}], " ", 
       RowBox[{"Sin", "[", "theta3", "]"}]}]},
     {
      RowBox[{"Sin", "[", "theta3", "]"}], 
      RowBox[{"Cos", "[", "theta3", "]"}], "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l1", "+", "l2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "theta3", "]"}]}], ")"}]}]},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.721573780260047*^9, 3.7215738065628633`*^9}, 
   3.7215743436892924`*^9, 3.721574723553941*^9, 3.7215822024673047`*^9, {
   3.721583160302783*^9, 3.7215832028610864`*^9}, 
   3.72167556613478*^9},ExpressionUUID->"2a3ccbcf-7545-4cf5-bc4a-\
ad0ec871f8a2"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"},
     {"0", "0", "1", "theta4"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.721573780260047*^9, 3.7215738065628633`*^9}, 
   3.7215743436892924`*^9, 3.721574723553941*^9, 3.7215822024673047`*^9, {
   3.721583160302783*^9, 3.7215832028610864`*^9}, 
   3.721675566136284*^9},ExpressionUUID->"bce5e781-83af-41b1-8823-\
3b1862429a2c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "theta5", "]"}], "0", 
      RowBox[{"Sin", "[", "theta5", "]"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"h", "+", "l3"}], ")"}]}], " ", 
       RowBox[{"Sin", "[", "theta5", "]"}]}]},
     {"0", "1", "0", "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "theta5", "]"}]}], "0", 
      RowBox[{"Cos", "[", "theta5", "]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"h", "+", "l3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Cos", "[", "theta5", "]"}]}], ")"}]}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.721573780260047*^9, 3.7215738065628633`*^9}, 
   3.7215743436892924`*^9, 3.721574723553941*^9, 3.7215822024673047`*^9, {
   3.721583160302783*^9, 3.7215832028610864`*^9}, 
   3.7216755661382885`*^9},ExpressionUUID->"9fdca708-e336-4bdd-bdcc-\
940b2695659d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "theta1", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "theta1", "]"}]}], "0", "0"},
     {
      RowBox[{"Sin", "[", "theta1", "]"}], 
      RowBox[{"Cos", "[", "theta1", "]"}], "0", "0"},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{
  3.721573716020717*^9},ExpressionUUID->"e0fb0118-29ba-4500-a149-\
857124aeae07"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "theta1", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "theta1", "]"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", "theta1", "]"}], ",", 
     RowBox[{"Cos", "[", "theta1", "]"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7215102008887444`*^9, {3.721510298409066*^9, 3.72151033516815*^9}, 
   3.7215271574422865`*^9, 3.721527207444132*^9, 3.7215312473860645`*^9, 
   3.7215319713648014`*^9, 3.7215321561323986`*^9, 3.7215322244994144`*^9, 
   3.721532353178972*^9, 3.7215326957869296`*^9, 3.721533036709717*^9, 
   3.7215331012552085`*^9, 3.721533456956365*^9, 3.7215737160507975`*^9, 
   3.721573811431961*^9, 3.721574728058064*^9, 3.721582205176591*^9, 
   3.7215832028847427`*^9, 
   3.7216755661453075`*^9},ExpressionUUID->"bfeef249-6b2d-43b8-876b-\
221ccc59f568"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Final", " ", "matrix", " ", "representation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"gst", ":=", " ", 
    RowBox[{
    "TwistExp1", ".", "TwistExp2", ".", "TwistExp3", ".", "TwistExp4", ".", 
     "TwistExp5", ".", "g0"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", "gst", "]"}], "  ", "//", " ", 
    "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.7215105480349646`*^9, 3.7215106085537577`*^9}, {
  3.721530809676174*^9, 3.721530814477708*^9}, {3.721531941991001*^9, 
  3.7215319625850945`*^9}, {3.721532340775837*^9, 
  3.7215323451166086`*^9}},ExpressionUUID->"41c28755-8282-423c-8421-\
0dfec3fc4464"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], " ", 
       RowBox[{"Cos", "[", "theta5", "]"}]}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], " ", 
       RowBox[{"Sin", "[", "theta5", "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "l1"}], " ", 
        RowBox[{"Sin", "[", "theta1", "]"}]}], "-", 
       RowBox[{"l2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"theta1", "+", "theta2"}], "]"}]}], "-", 
       RowBox[{"l3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], " ", 
        RowBox[{"Sin", "[", "theta5", "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"Cos", "[", "theta5", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}]}], 
      RowBox[{"Cos", "[", 
       RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], 
      RowBox[{
       RowBox[{"Sin", "[", 
        RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], " ", 
       RowBox[{"Sin", "[", "theta5", "]"}]}], 
      RowBox[{
       RowBox[{"l1", " ", 
        RowBox[{"Cos", "[", "theta1", "]"}]}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"theta1", "+", "theta2"}], "]"}]}], "-", 
       RowBox[{"l3", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], " ", 
        RowBox[{"Sin", "[", "theta5", "]"}]}]}]},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "theta5", "]"}]}], "0", 
      RowBox[{"Cos", "[", "theta5", "]"}], 
      RowBox[{"h", "+", "l3", "+", "theta4", "-", 
       RowBox[{"l3", " ", 
        RowBox[{"Cos", "[", "theta5", "]"}]}]}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7215105800656333`*^9, 3.721510609943451*^9}, 
   3.7215271581352777`*^9, 3.721527207500672*^9, 3.7215308159162087`*^9, 
   3.721531247437601*^9, 3.721531971408721*^9, 3.7215321561814337`*^9, 
   3.721532224527935*^9, 3.7215323539234977`*^9, 3.7215326962974987`*^9, 
   3.721533037153043*^9, 3.72153310169588*^9, 3.7215334571249847`*^9, 
   3.7215737837880363`*^9, 3.7215738142906485`*^9, 3.721574732849949*^9, 
   3.7215822086554513`*^9, 3.721582497542665*^9, 3.721583203019107*^9, 
   3.7216755663583746`*^9},ExpressionUUID->"ddc5968d-2bda-4717-8195-\
a2239e95f60f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Examine", " ", "certain", " ", "cases", " ", "of", " ", "the", " ", 
    "transformation", " ", "from", " ", "stationary", " ", "to", " ", "tool", 
    " ", "frame"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"gst", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"theta1", "\[Rule]", "0"}], ",", " ", 
        RowBox[{"theta2", "\[Rule]", "0"}], ",", " ", 
        RowBox[{"theta3", "\[Rule]", "0"}]}], "}"}]}], "]"}], " ", "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"gst", "/.", 
      RowBox[{"{", 
       RowBox[{"theta5", "\[Rule]", "0"}], "}"}]}], "]"}], " ", "//", 
    "MatrixForm"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7215306713191247`*^9, 3.7215307019952664`*^9}, {
   3.7215307939696655`*^9, 3.721530867710475*^9}, {3.7215309419597178`*^9, 
   3.721530980053746*^9}, {3.7215312216507025`*^9, 3.7215312406970873`*^9}, 
   3.7215324290879536`*^9},ExpressionUUID->"660f5a4a-2fa1-463b-be4c-\
f0641f751c98"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "theta5", "]"}], "0", 
      RowBox[{"Sin", "[", "theta5", "]"}], 
      RowBox[{
       RowBox[{"-", "l3"}], " ", 
       RowBox[{"Sin", "[", "theta5", "]"}]}]},
     {"0", "1", "0", 
      RowBox[{"l1", "+", "l2"}]},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "theta5", "]"}]}], "0", 
      RowBox[{"Cos", "[", "theta5", "]"}], 
      RowBox[{"h", "+", "l3", "+", "theta4", "-", 
       RowBox[{"l3", " ", 
        RowBox[{"Cos", "[", "theta5", "]"}]}]}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7215308327597914`*^9, 3.721530868314149*^9}, 
   3.721530981276827*^9, 3.7215312474766293`*^9, 3.7215319714357395`*^9, 
   3.7215321562049503`*^9, 3.7215322245569553`*^9, 3.7215323539725327`*^9, 
   3.721532696315011*^9, 3.7215330371685534`*^9, 3.7215331017118917`*^9, 
   3.721533457140996*^9, 3.721573719795868*^9, 3.721573786813678*^9, 
   3.7215738170992036`*^9, 3.721574735745739*^9, 3.7215822109887395`*^9, 
   3.721583203031139*^9, 
   3.721675566365393*^9},ExpressionUUID->"dab35a69-bcbf-43d7-a344-\
1025761e63a7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "l1"}], " ", 
        RowBox[{"Sin", "[", "theta1", "]"}]}], "-", 
       RowBox[{"l2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"theta1", "+", "theta2"}], "]"}]}]}]},
     {
      RowBox[{"Sin", "[", 
       RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"theta1", "+", "theta2", "+", "theta3"}], "]"}], "0", 
      RowBox[{
       RowBox[{"l1", " ", 
        RowBox[{"Cos", "[", "theta1", "]"}]}], "+", 
       RowBox[{"l2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"theta1", "+", "theta2"}], "]"}]}]}]},
     {"0", "0", "1", 
      RowBox[{"h", "+", "theta4"}]},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7215308327597914`*^9, 3.721530868314149*^9}, 
   3.721530981276827*^9, 3.7215312474766293`*^9, 3.7215319714357395`*^9, 
   3.7215321562049503`*^9, 3.7215322245569553`*^9, 3.7215323539725327`*^9, 
   3.721532696315011*^9, 3.7215330371685534`*^9, 3.7215331017118917`*^9, 
   3.721533457140996*^9, 3.721573719795868*^9, 3.721573786813678*^9, 
   3.7215738170992036`*^9, 3.721574735745739*^9, 3.7215822109887395`*^9, 
   3.721583203031139*^9, 
   3.72167556639447*^9},ExpressionUUID->"c3c5b32b-c88c-4778-a41a-\
293feb5949dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 FormBox[
  RowBox[{
   RowBox[{"AdjointTransformation", "(", "matrix_", ")"}], ":=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]},
             {
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]},
             {
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          RowBox[{
           RowBox[{"vecToSkew", "(", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "4"}], "\[RightDoubleBracket]"}]}], "}"}], 
            ")"}], ".", 
           RowBox[{"(", "\[NoBreak]", GridBox[{
              {
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]},
              {
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], 
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]},
              {
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], 
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], 
               RowBox[{"matrix", "\[LeftDoubleBracket]", 
                RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}
             },
             
             GridBoxAlignment->{
              "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
               "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
             GridBoxSpacings->{"Columns" -> {
                 Offset[0.27999999999999997`], {
                  Offset[0.7]}, 
                 Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
               "Rows" -> {
                 Offset[0.2], {
                  Offset[0.4]}, 
                 Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}], 
     ",", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0", "0", "0"},
             {"0", "0", "0"},
             {"0", "0", "0"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]},
             {
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]},
             {
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], 
              RowBox[{"matrix", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "3"}], "\[RightDoubleBracket]"}]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[0.7]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, 
          "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], "]"}]}],
     "]"}]}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"xi1A", ":=", "Xi1"}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"xi2A", ":=", 
   RowBox[{
    RowBox[{"AdjointTransformation", "(", "TwistExp1", ")"}], ".", "Xi2"}]}], 
  TraditionalForm], "\n", 
 FormBox[
  RowBox[{"xi3A", ":=", 
   RowBox[{
    RowBox[{"AdjointTransformation", "(", 
     RowBox[{"TwistExp1", ".", "TwistExp2"}], ")"}], ".", "Xi3"}]}], 
  TraditionalForm], "\n", 
 FormBox[
  RowBox[{"xi4A", ":=", 
   RowBox[{
    RowBox[{"AdjointTransformation", "(", 
     RowBox[{"TwistExp1", ".", "TwistExp2", ".", "TwistExp3"}], ")"}], ".", 
    "Xi4"}]}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"xi5A", ":=", 
   RowBox[{
    RowBox[{"AdjointTransformation", "(", 
     RowBox[{
     "TwistExp1", ".", "TwistExp2", ".", "TwistExp3", ".", "TwistExp4"}], 
     ")"}], ".", "Xi5"}]}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"Jacob", ":=", 
   RowBox[{"FullSimplify", "[", 
    TemplateBox[{RowBox[{"{", 
        RowBox[{"xi1A", ",", "xi2A", ",", "xi3A", ",", "xi4A", ",", "xi5A"}], 
        "}"}]},
     "Transpose"], "]"}]}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"l1", "=", "1"}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"l2", "=", "1"}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"t5", "=", "0"}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"t4", "=", 
   RowBox[{
    RowBox[{"-", "h"}], "+", 
    RowBox[{"l3", " ", 
     RowBox[{"cos", "(", "t5", ")"}]}], "-", "l3", "+", "0"}]}], 
  TraditionalForm], "\n", 
 FormBox[
  RowBox[{"r", "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"l3", " ", 
         RowBox[{"sin", "(", "t5", ")"}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{"t1", "+", "t2", "+", "t3"}], ")"}]}], "-", "l2"}], ")"}], 
      "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"l1", "+", 
        RowBox[{"l3", " ", 
         RowBox[{"sin", "(", "t5", ")"}], " ", 
         RowBox[{"sin", "(", 
          RowBox[{"t1", "+", "t2", "+", "t3"}], ")"}]}]}], ")"}], "2"]}]]}], 
  TraditionalForm], "\n", 
 FormBox[
  RowBox[{"t2", "=", 
   RowBox[{"\[Pi]", "-", 
    RowBox[{
     SuperscriptBox["cos", 
      RowBox[{"-", "1"}]], "(", 
     FractionBox[
      RowBox[{
       SuperscriptBox["l1", "2"], "+", 
       SuperscriptBox["l2", "2"], "-", 
       SuperscriptBox["r", "2"]}], 
      RowBox[{"2", " ", "l1", " ", "l2"}]], ")"}]}]}], TraditionalForm], "\n", 
 FormBox[
  RowBox[{"t1", "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox["tan", 
      RowBox[{"-", "1"}]], "(", 
     RowBox[{
      RowBox[{"l1", "+", 
       RowBox[{"l3", " ", 
        RowBox[{"sin", "(", "t5", ")"}], " ", 
        RowBox[{"sin", "(", 
         RowBox[{"t1", "+", "t2", "+", "t3"}], ")"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"l3", " ", 
        RowBox[{"sin", "(", "t5", ")"}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{"t1", "+", "t2", "+", "t3"}], ")"}]}], "-", "l2"}]}], ")"}], 
    "-", 
    RowBox[{
     SuperscriptBox["cos", 
      RowBox[{"-", "1"}]], "(", 
     FractionBox[
      RowBox[{
       SuperscriptBox["l1", "2"], "-", 
       SuperscriptBox["l2", "2"], "+", 
       SuperscriptBox["r", "2"]}], 
      RowBox[{"2", " ", "l1", " ", "r"}]], ")"}]}]}], 
  TraditionalForm], "\n", 
 FormBox[
  RowBox[{"t3", "=", 
   RowBox[{"p", "-", "t1", "-", "t2"}]}], TraditionalForm]}], "Input",
 CellChangeTimes->{{3.721540643036008*^9, 3.7215406723333044`*^9}, {
   3.72154195098018*^9, 3.7215419601420527`*^9}, {3.72154328891889*^9, 
   3.7215433066636057`*^9}, {3.721543705411397*^9, 3.7215437169985647`*^9}, {
   3.721543748733899*^9, 3.7215437805053363`*^9}, {3.7215438266855507`*^9, 
   3.721543877555373*^9}, {3.7215439092787104`*^9, 3.721543920050682*^9}, {
   3.7215441622423916`*^9, 3.721544164411725*^9}, {3.7215442525914435`*^9, 
   3.721544284189966*^9}, {3.7215443213735027`*^9, 3.7215443374387393`*^9}, 
   3.7215704255873127`*^9, {3.721570652165897*^9, 3.7215706674325066`*^9}, {
   3.7215709703203707`*^9, 3.7215710441447334`*^9}, {3.7215712955631623`*^9, 
   3.7215713117747555`*^9}, {3.721571812154994*^9, 3.7215718850160103`*^9}, {
   3.7215720299291306`*^9, 3.72157204337127*^9}, {3.7215721631447353`*^9, 
   3.7215722231256323`*^9}, {3.7215726106305885`*^9, 3.72157301988682*^9}, {
   3.721573124673295*^9, 3.7215731273645315`*^9}, {3.721573286824197*^9, 
   3.721573298834647*^9}, {3.7215733520677614`*^9, 3.7215734015872393`*^9}, {
   3.721573433400798*^9, 3.721573613836063*^9}, {3.7215736691529827`*^9, 
   3.721573693248287*^9}, {3.721573743576706*^9, 3.721573746435397*^9}, {
   3.7215747559945326`*^9, 3.721574758714845*^9}, {3.721574791964942*^9, 
   3.7215749126187153`*^9}, {3.721575326829178*^9, 3.721575368250066*^9}, {
   3.721575465705721*^9, 3.7215754952348537`*^9}, {3.7215755308223133`*^9, 
   3.721575541042798*^9}, 3.7215782206340113`*^9, {3.7215792786619062`*^9, 
   3.7215793318313403`*^9}, {3.7215796935576015`*^9, 3.721579776493767*^9}, {
   3.721579826562446*^9, 3.721579869376608*^9}, 3.7215799093455696`*^9, {
   3.7215801500551343`*^9, 3.7215801643325243`*^9}, {3.7215803334318027`*^9, 
   3.721580336490031*^9}, {3.721580708168615*^9, 3.7215807142469645`*^9}, {
   3.721580772972804*^9, 3.721580787231145*^9}, {3.7215808486519995`*^9, 
   3.721580848857552*^9}, {3.721580892445611*^9, 3.721580971393075*^9}, {
   3.721581007112742*^9, 3.7215810359811077`*^9}, {3.721581070529005*^9, 
   3.7215811318916454`*^9}, {3.7215811723128185`*^9, 3.721581222249076*^9}, {
   3.7215812789301357`*^9, 3.721581285350404*^9}, {3.7215817021216717`*^9, 
   3.7215817056581793`*^9}, {3.7215817376417418`*^9, 
   3.7215818159613447`*^9}, {3.721581870378377*^9, 3.7215819096591296`*^9}, {
   3.7215819716909847`*^9, 3.7215819765089445`*^9}, {3.72158205395653*^9, 
   3.7215820549241333`*^9}, {3.721582102581817*^9, 3.7215821606485786`*^9}, {
   3.7215822652182646`*^9, 3.721582265878039*^9}, {3.721582816899871*^9, 
   3.721582817550623*^9}, 3.7215995073207493`*^9, {3.7216007544774365`*^9, 
   3.7216008280177493`*^9}, {3.721600898955512*^9, 3.721600903912348*^9}, {
   3.7216022161821756`*^9, 3.7216022266422987`*^9}, {3.721602284815414*^9, 
   3.7216023457823763`*^9}, {3.7216023850042677`*^9, 
   3.7216024115677156`*^9}, {3.7216024528603687`*^9, 
   3.7216024540124664`*^9}, {3.7216025062435007`*^9, 
   3.7216025349812846`*^9}, {3.721602594771135*^9, 3.72160284042759*^9}, {
   3.721606985480996*^9, 3.721606988305094*^9}, {3.7216073026951485`*^9, 
   3.7216073916341624`*^9}, {3.7216074670315495`*^9, 3.721607480668248*^9}, {
   3.7216755836523805`*^9, 3.7216756687928824`*^9}, {3.7216797243430357`*^9, 
   3.7216798307133384`*^9}, {3.7216906737905245`*^9, 3.72169067954784*^9}, 
   3.7217054629744363`*^9, {3.721755840570174*^9, 3.721755841065505*^9}, {
   3.7217558903917456`*^9, 3.7217559942431912`*^9}, {3.721756085486581*^9, 
   3.721756241911208*^9}, {3.7217563560428286`*^9, 3.7217565815141325`*^9}, {
   3.72175665228841*^9, 3.721756652392186*^9}, {3.72175675152392*^9, 
   3.721756786443316*^9}, {3.7217585609063177`*^9, 3.7217585980126114`*^9}, {
   3.7217587211350327`*^9, 3.7217587215822325`*^9}, 3.7217589239125376`*^9, {
   3.721758991353228*^9, 3.7217590288376365`*^9}, {3.721759085957531*^9, 
   3.721759086072341*^9}, {3.7217591627153635`*^9, 3.7217592003538113`*^9}, {
   3.7217593169409122`*^9, 3.721759322315359*^9}, {3.7217594430771766`*^9, 
   3.721759563376809*^9}, 3.7217596070679073`*^9, {3.7217596943501425`*^9, 
   3.7217597028881054`*^9}, {3.721759785397953*^9, 
   3.7217597931021805`*^9}},ExpressionUUID->"abb7e340-0d8d-4c57-b960-\
a914956b4cac"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.721756512635401*^9, 3.721756530402665*^9}, {
   3.721756565005215*^9, 3.7217565832958727`*^9}, {3.7217566246042614`*^9, 
   3.7217566528463945`*^9}, {3.721756761814294*^9, 3.72175678675314*^9}, {
   3.7217585617646227`*^9, 3.7217585984457755`*^9}, 3.721758722117676*^9, 
   3.7217589946581163`*^9, {3.721759024955182*^9, 3.721759030048894*^9}, 
   3.721759086519041*^9, {3.721759163495464*^9, 3.721759201972698*^9}, 
   3.721759322616168*^9, {3.721759445699074*^9, 3.7217594555656157`*^9}, 
   3.721759526580615*^9, 3.7217595636344995`*^9, 
   3.721759793432571*^9},ExpressionUUID->"86ae5890-e7ba-4f20-a7e4-\
7d556e181c8b"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.721756512635401*^9, 3.721756530402665*^9}, {
   3.721756565005215*^9, 3.7217565832958727`*^9}, {3.7217566246042614`*^9, 
   3.7217566528463945`*^9}, {3.721756761814294*^9, 3.72175678675314*^9}, {
   3.7217585617646227`*^9, 3.7217585984457755`*^9}, 3.721758722117676*^9, 
   3.7217589946581163`*^9, {3.721759024955182*^9, 3.721759030048894*^9}, 
   3.721759086519041*^9, {3.721759163495464*^9, 3.721759201972698*^9}, 
   3.721759322616168*^9, {3.721759445699074*^9, 3.7217594555656157`*^9}, 
   3.721759526580615*^9, 3.7217595636344995`*^9, 
   3.7217597934355803`*^9},ExpressionUUID->"ec655424-6e7f-4676-9687-\
08178f29b2fb"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.721756512635401*^9, 3.721756530402665*^9}, {
   3.721756565005215*^9, 3.7217565832958727`*^9}, {3.7217566246042614`*^9, 
   3.7217566528463945`*^9}, {3.721756761814294*^9, 3.72175678675314*^9}, {
   3.7217585617646227`*^9, 3.7217585984457755`*^9}, 3.721758722117676*^9, 
   3.7217589946581163`*^9, {3.721759024955182*^9, 3.721759030048894*^9}, 
   3.721759086519041*^9, {3.721759163495464*^9, 3.721759201972698*^9}, 
   3.721759322616168*^9, {3.721759445699074*^9, 3.7217594555656157`*^9}, 
   3.721759526580615*^9, 3.7217595636344995`*^9, 
   3.7217597934365816`*^9},ExpressionUUID->"19effb8d-1f4b-42c0-b120-\
1608d7405970"],

Cell[BoxData[
 RowBox[{"-", "h"}]], "Output",
 CellChangeTimes->{{3.721756512635401*^9, 3.721756530402665*^9}, {
   3.721756565005215*^9, 3.7217565832958727`*^9}, {3.7217566246042614`*^9, 
   3.7217566528463945`*^9}, {3.721756761814294*^9, 3.72175678675314*^9}, {
   3.7217585617646227`*^9, 3.7217585984457755`*^9}, 3.721758722117676*^9, 
   3.7217589946581163`*^9, {3.721759024955182*^9, 3.721759030048894*^9}, 
   3.721759086519041*^9, {3.721759163495464*^9, 3.721759201972698*^9}, 
   3.721759322616168*^9, {3.721759445699074*^9, 3.7217594555656157`*^9}, 
   3.721759526580615*^9, 3.7217595636344995`*^9, 
   3.721759793438587*^9},ExpressionUUID->"5cc7a27f-054f-4fb0-886e-\
a4d6d59ca7e0"],

Cell[BoxData[
 SqrtBox["2"]], "Output",
 CellChangeTimes->{{3.721756512635401*^9, 3.721756530402665*^9}, {
   3.721756565005215*^9, 3.7217565832958727`*^9}, {3.7217566246042614`*^9, 
   3.7217566528463945`*^9}, {3.721756761814294*^9, 3.72175678675314*^9}, {
   3.7217585617646227`*^9, 3.7217585984457755`*^9}, 3.721758722117676*^9, 
   3.7217589946581163`*^9, {3.721759024955182*^9, 3.721759030048894*^9}, 
   3.721759086519041*^9, {3.721759163495464*^9, 3.721759201972698*^9}, 
   3.721759322616168*^9, {3.721759445699074*^9, 3.7217594555656157`*^9}, 
   3.721759526580615*^9, 3.7217595636344995`*^9, 
   3.7217597934395895`*^9},ExpressionUUID->"d1805d7e-8daa-4c7b-b831-\
65506cdfd21d"],

Cell[BoxData[
 FractionBox["\[Pi]", "2"]], "Output",
 CellChangeTimes->{{3.721756512635401*^9, 3.721756530402665*^9}, {
   3.721756565005215*^9, 3.7217565832958727`*^9}, {3.7217566246042614`*^9, 
   3.7217566528463945`*^9}, {3.721756761814294*^9, 3.72175678675314*^9}, {
   3.7217585617646227`*^9, 3.7217585984457755`*^9}, 3.721758722117676*^9, 
   3.7217589946581163`*^9, {3.721759024955182*^9, 3.721759030048894*^9}, 
   3.721759086519041*^9, {3.721759163495464*^9, 3.721759201972698*^9}, 
   3.721759322616168*^9, {3.721759445699074*^9, 3.7217594555656157`*^9}, 
   3.721759526580615*^9, 3.7217595636344995`*^9, 
   3.721759793441595*^9},ExpressionUUID->"6a23f6db-25d7-4987-b09c-\
9bf754572322"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["\[Pi]", "2"]}]], "Output",
 CellChangeTimes->{{3.721756512635401*^9, 3.721756530402665*^9}, {
   3.721756565005215*^9, 3.7217565832958727`*^9}, {3.7217566246042614`*^9, 
   3.7217566528463945`*^9}, {3.721756761814294*^9, 3.72175678675314*^9}, {
   3.7217585617646227`*^9, 3.7217585984457755`*^9}, 3.721758722117676*^9, 
   3.7217589946581163`*^9, {3.721759024955182*^9, 3.721759030048894*^9}, 
   3.721759086519041*^9, {3.721759163495464*^9, 3.721759201972698*^9}, 
   3.721759322616168*^9, {3.721759445699074*^9, 3.7217594555656157`*^9}, 
   3.721759526580615*^9, 3.7217595636344995`*^9, 
   3.7217597934436007`*^9},ExpressionUUID->"2df52a9d-14a5-4847-9747-\
ab7c297ffd71"],

Cell[BoxData["p"], "Output",
 CellChangeTimes->{{3.721756512635401*^9, 3.721756530402665*^9}, {
   3.721756565005215*^9, 3.7217565832958727`*^9}, {3.7217566246042614`*^9, 
   3.7217566528463945`*^9}, {3.721756761814294*^9, 3.72175678675314*^9}, {
   3.7217585617646227`*^9, 3.7217585984457755`*^9}, 3.721758722117676*^9, 
   3.7217589946581163`*^9, {3.721759024955182*^9, 3.721759030048894*^9}, 
   3.721759086519041*^9, {3.721759163495464*^9, 3.721759201972698*^9}, 
   3.721759322616168*^9, {3.721759445699074*^9, 3.7217594555656157`*^9}, 
   3.721759526580615*^9, 3.7217595636344995`*^9, 
   3.721759793444603*^9},ExpressionUUID->"c2f08afc-4b4a-4338-85f4-\
e88104647cce"]
}, Open  ]],

Cell[BoxData[
 FormBox["", TraditionalForm]], "Input",
 CellChangeTimes->{{3.7215828294195395`*^9, 3.721582833350109*^9}, 
   3.721583229356981*^9, 
   3.721690459006135*^9},ExpressionUUID->"de7397c3-55a0-43ea-a039-\
5438d63a3e9b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.721544553171462*^9, {3.72157537414793*^9, 3.7215753748778934`*^9}, {
   3.721575420381242*^9, 3.721575424633673*^9}, {3.7215755033604617`*^9, 
   3.72157550353393*^9}, {3.7215756308528876`*^9, 3.721575665985198*^9}, {
   3.721575715412788*^9, 3.721575742650981*^9}, {3.7215782269454823`*^9, 
   3.721578254173258*^9}, {3.7215784140790205`*^9, 3.7215784431847844`*^9}, {
   3.721578476023821*^9, 3.7215785167422433`*^9}, 3.7215785604352875`*^9, {
   3.721578614951874*^9, 3.721578715896472*^9}, {3.721578836827112*^9, 
   3.721578913227809*^9}, {3.721578954104723*^9, 3.721578970416583*^9}, {
   3.7215790005606465`*^9, 3.721579074767939*^9}, {3.721579122084771*^9, 
   3.7215792769608335`*^9}, {3.7215800659020925`*^9, 3.721580089686634*^9}, 
   3.7215827900105658`*^9, 3.721583222670965*^9, {3.721690462728036*^9, 
   3.7216904752678947`*^9}, {3.7216906535160875`*^9, 3.721690658779089*^9}, 
   3.721755834998626*^9},ExpressionUUID->"16b1578a-f42a-4c79-8408-\
7ac15e6f4f1a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721580374613566*^9, 3.721580429008849*^9}, {
   3.721580654377084*^9, 3.7215806560796633`*^9}, 3.721582232414899*^9, {
   3.7216028417321005`*^9, 3.7216028593514986`*^9}, {3.721602895372406*^9, 
   3.721602977770582*^9}, {3.721603012055793*^9, 3.7216030802529736`*^9}, {
   3.721675571458943*^9, 
   3.721675573075243*^9}},ExpressionUUID->"3ad6a2d8-f404-4313-8ed4-\
1dd69b80af03"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721580641259476*^9, 3.7215806427548327`*^9}, 
   3.721582230281189*^9, 3.7216029442695847`*^9, 
   3.7216755741165133`*^9},ExpressionUUID->"f5ffda9e-8d3b-4e9c-a9bf-\
20a45ab687e3"],

Cell[BoxData[
 FormBox["", TraditionalForm]], "Input",
 CellChangeTimes->{{3.721582234800312*^9, 
  3.721582239606253*^9}},ExpressionUUID->"840c66c4-77e1-445a-a18a-\
3a54b3b9b6b8"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.721582228012083*^9},ExpressionUUID->"518f321a-8092-45c1-ba40-\
cdf3ec55b92c"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{3.721582225647724*^9, 
  3.721756622218916*^9},ExpressionUUID->"1642b81b-167d-4604-905a-\
8288148e24c7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.72158222482952*^9},ExpressionUUID->"f1dc4e6f-48b3-469c-8871-7e819f95eac7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721581852511321*^9, 3.721581852688799*^9}, 
   3.721581922305151*^9, 
   3.721582223725552*^9},ExpressionUUID->"f228074e-ca4d-4f07-bfeb-\
b3680cb010b6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721750236712824*^9, 3.7217503177338667`*^9}, {
   3.721750351494686*^9, 3.7217504609283085`*^9}, {3.721750495624614*^9, 
   3.721750497873597*^9}, 3.7217512274752293`*^9, 3.721751600542938*^9, {
   3.721751633336153*^9, 3.7217516347820396`*^9}, 3.7217516669535913`*^9, {
   3.7217517372271843`*^9, 3.721751741470093*^9}, {3.721752687871871*^9, 
   3.7217527051007276`*^9}, 3.7217558302481346`*^9, {3.7246414990657053`*^9, 
   3.724641601669076*^9}, {3.7246416375012865`*^9, 3.72464163782217*^9}, {
   3.7246416692322044`*^9, 3.724641669766694*^9}, {3.7246417486598854`*^9, 
   3.7246417489717364`*^9}, {3.7246419404319983`*^9, 3.724641960770088*^9}, {
   3.7246421148006163`*^9, 3.7246421287537923`*^9}, {3.724644931193591*^9, 
   3.7246449608533373`*^9}, {3.7246450060491815`*^9, 3.7246450065776224`*^9}, 
   3.7265042433121233`*^9},ExpressionUUID->"7a3665b4-0dd9-4970-b34f-\
0ffb125a66a2"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721752980238308*^9, 3.7217531158698235`*^9}, 
   3.72175582738595*^9, 3.724641798574589*^9, {3.724642149659098*^9, 
   3.7246421509215674`*^9}, {3.7246421920250425`*^9, 3.724642209451923*^9}, {
   3.724644398629491*^9, 3.7246444054311247`*^9}, 
   3.7246449590183315`*^9},ExpressionUUID->"c9e7d94a-1c77-4174-a9f9-\
30db71cee6ea"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"cos", "(", "theta1", ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{"theta2", "+", "theta3"}], ")"}]}], 
      RowBox[{"-", 
       RowBox[{"sin", "(", "theta1", ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"cos", "(", "theta1", ")"}]}], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"theta2", "+", "theta3"}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"l1", "+", "l2"}], ")"}]}], " ", 
       RowBox[{"sin", "(", "theta1", ")"}]}]},
     {
      RowBox[{
       RowBox[{"cos", "(", 
        RowBox[{"theta2", "+", "theta3"}], ")"}], " ", 
       RowBox[{"sin", "(", "theta1", ")"}]}], 
      RowBox[{"cos", "(", "theta1", ")"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"sin", "(", "theta1", ")"}]}], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"theta2", "+", "theta3"}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"l1", "+", "l2"}], ")"}], " ", 
       RowBox[{"cos", "(", "theta1", ")"}]}]},
     {
      RowBox[{"sin", "(", 
       RowBox[{"theta2", "+", "theta3"}], ")"}], "0", 
      RowBox[{"cos", "(", 
       RowBox[{"theta2", "+", "theta3"}], ")"}], "h"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.724642151245451*^9, 3.72464221329543*^9}, {
  3.724644406167129*^9, 
  3.7246444137438545`*^9}},ExpressionUUID->"9f19b806-659c-4290-a110-\
5e0620ff083b"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.721755823802011*^9, 3.721755823814043*^9}, {
   3.724685819240323*^9, 3.724685831483262*^9}, {3.7246858627879977`*^9, 
   3.72468595916665*^9}, {3.7246860069110513`*^9, 3.724686010185008*^9}, {
   3.724686268026804*^9, 3.724686300910288*^9}, {3.724686331642925*^9, 
   3.7246863335050263`*^9}, {3.72468637540211*^9, 3.72468639173816*^9}, {
   3.7246864730165777`*^9, 3.724686559767687*^9}, {3.724686603375556*^9, 
   3.7246866499731994`*^9}, 
   3.7265042514783735`*^9},ExpressionUUID->"318d27d0-526e-46cb-91a1-\
e71d66f74784"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7247024988717594`*^9, 3.724702502571865*^9}, {
   3.7247025853229475`*^9, 3.724702593723799*^9}, {3.724702649728622*^9, 
   3.7247026576342936`*^9}, 
   3.726504265303056*^9},ExpressionUUID->"8f88fe74-471e-45e4-adb9-\
d85fe172241f"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7247128295486126`*^9, 3.7247128300790577`*^9}, 
   3.724714592678916*^9},ExpressionUUID->"89816be7-6fca-4913-a4e7-\
461ac3d0af8e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7247101292948675`*^9, 3.72471026083444*^9}, {
   3.724710412527417*^9, 3.7247104185444345`*^9}, {3.7247107581451907`*^9, 
   3.724710774905115*^9}, {3.7247108414793124`*^9, 3.7247108516571703`*^9}, {
   3.7247115613553295`*^9, 3.7247115818604*^9}, {3.7247116227324953`*^9, 
   3.724711633563367*^9}, {3.724711825960343*^9, 3.7247118280600967`*^9}, {
   3.724712081709694*^9, 3.7247121019835796`*^9}, {3.724712131992883*^9, 
   3.724712151214032*^9}, {3.7247128107485847`*^9, 3.7247128112785234`*^9}, {
   3.7247128503687677`*^9, 3.7247128527984233`*^9}, {3.7247129374928555`*^9, 
   3.7247129410175133`*^9}, {3.7247130188044987`*^9, 
   3.7247130247951126`*^9}, {3.724713670125243*^9, 3.7247136928371882`*^9}, {
   3.7247137290582094`*^9, 3.724713731468305*^9}, {3.724713975979493*^9, 
   3.724713984273213*^9}, {3.7247141049719257`*^9, 3.7247141088615713`*^9}, {
   3.724714214723253*^9, 3.7247142563496184`*^9}, {3.724714386594987*^9, 
   3.72471453324831*^9}, {3.7247145691490073`*^9, 3.724714820587118*^9}, {
   3.7247150426064835`*^9, 3.7247150646987247`*^9}, {3.724715121918467*^9, 
   3.724715161521373*^9}, {3.724715656981081*^9, 3.724715728673544*^9}, {
   3.724715927072365*^9, 3.724715931104434*^9}, {3.7247212061975203`*^9, 
   3.724721216056368*^9}, {3.724721266843742*^9, 3.724721274421517*^9}, {
   3.7247233522108183`*^9, 3.7247233941213627`*^9}, {3.7247235260633087`*^9, 
   3.7247235311618958`*^9}, {3.7247643088060026`*^9, 3.724764337044635*^9}, {
   3.7247643688773174`*^9, 3.72476436931398*^9}, {3.7247644248151617`*^9, 
   3.7247644851366878`*^9}, {3.724764740835881*^9, 3.7247648023871374`*^9}, {
   3.7247648593213224`*^9, 3.7247648639219103`*^9}, {3.7247649263399053`*^9, 
   3.724764934423905*^9}, {3.724765077470826*^9, 3.7247651197814426`*^9}, {
   3.7247658953012257`*^9, 3.724765945102781*^9}, {3.7247661121973386`*^9, 
   3.724766133122654*^9}, {3.724766440046733*^9, 3.7247664494820337`*^9}, {
   3.7247668514426947`*^9, 3.7247668548470287`*^9}, {3.7247669087375755`*^9, 
   3.724766926855255*^9}, {3.724767425040796*^9, 3.7247674338129454`*^9}, 
   3.7247675402678137`*^9, {3.724768386653842*^9, 3.7247683993675833`*^9}, 
   3.7247694767665663`*^9, 3.724769825273885*^9, {3.724769857453126*^9, 
   3.7247698635204496`*^9}, {3.724770035282858*^9, 3.7247700372151546`*^9}, {
   3.724773485194654*^9, 3.7247734961738825`*^9}, 
   3.7265042559079466`*^9},ExpressionUUID->"1443f2c2-ee78-40ad-b3f6-\
52bf7e51f2d9"],

Cell[BoxData["|"], "Input",
 CellChangeTimes->{
  3.724767434216185*^9},ExpressionUUID->"4a320d57-6470-44a9-8b5d-\
12028b72ad90"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.724713047500703*^9, 3.7247139916163197`*^9, {3.7247648066618433`*^9, 
   3.724764813504567*^9}, {3.7247649672861676`*^9, 3.7247649675378537`*^9}, {
   3.724765040646747*^9, 3.7247650511512423`*^9}, {3.724768624404478*^9, 
   3.724768748928098*^9}, {3.7247689605543785`*^9, 3.724768973618898*^9}, {
   3.7247690115759735`*^9, 3.724769052596626*^9}, {3.72476923836748*^9, 
   3.724769239088711*^9}, 3.724769349076283*^9, {3.724769560658496*^9, 
   3.7247696895179005`*^9}, {3.7247699221340933`*^9, 3.724769963321164*^9}, 
   3.7265042586799955`*^9},ExpressionUUID->"9fb2a966-04b5-4dbe-9404-\
e47c25629e41"],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.724711613376134*^9, 3.724711616555826*^9}, {
   3.724712255233204*^9, 3.724712263361605*^9}, {3.7247139984408283`*^9, 
   3.7247139985782003`*^9}, {3.7247147024585924`*^9, 
   3.7247148375444593`*^9}, {3.724764492980053*^9, 3.724764493264307*^9}, 
   3.726504224835711*^9},ExpressionUUID->"75c9c6d3-607d-4eb2-bfa2-\
95f29376c2d9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.724714840315043*^9},ExpressionUUID->"a7fb54f2-074e-4ff6-b497-\
2b1af8ba09d4"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7247856614900475`*^9, 3.724785665409479*^9}, {
   3.724786798319081*^9, 3.724786829353959*^9}, 
   3.726504262013055*^9},ExpressionUUID->"26ab2315-0893-46a6-81fb-\
47b6e14ec5bf"]
},
WindowSize->{958, 988},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1156, 26, 69, "Input", "ExpressionUUID" -> \
"eaf0cf27-0c46-44b8-856e-201e8b237385"],
Cell[1717, 48, 179, 3, 30, "Input", "ExpressionUUID" -> \
"c8cabb1d-0e8d-4061-9659-7f7be289a460"],
Cell[1899, 53, 180, 4, 30, "Input", "ExpressionUUID" -> \
"b23e6e56-0074-4449-ba0c-7a8a41fade4b"],
Cell[2082, 59, 152, 3, 30, "Input", "ExpressionUUID" -> \
"5681b5d7-d807-4a7c-a5cb-3e665b03a576"],
Cell[2237, 64, 7397, 173, 392, "Input", "ExpressionUUID" -> \
"0322f2ff-cde8-447b-a434-c71a1e53595c"],
Cell[9637, 239, 1817, 40, 126, "Input", "ExpressionUUID" -> \
"74472697-73d8-44dd-95ff-7d3b43c46981"],
Cell[CellGroupData[{
Cell[11479, 283, 3497, 83, 221, "Input", "ExpressionUUID" -> \
"56eef097-f174-43c4-839e-d61b6d6e6960"],
Cell[14979, 368, 1115, 29, 80, "Output", "ExpressionUUID" -> \
"7e83ff24-071f-4f9a-9598-8cb74c1d4cbb"],
Cell[16097, 399, 1312, 35, 80, "Output", "ExpressionUUID" -> \
"cfcb9e5d-e8b4-4d7b-99ae-f129172b6e4b"],
Cell[17412, 436, 1425, 39, 80, "Output", "ExpressionUUID" -> \
"2a3ccbcf-7545-4cf5-bc4a-ad0ec871f8a2"],
Cell[18840, 477, 941, 24, 80, "Output", "ExpressionUUID" -> \
"bce5e781-83af-41b1-8823-3b1862429a2c"],
Cell[19784, 503, 1451, 40, 80, "Output", "ExpressionUUID" -> \
"9fdca708-e336-4bdd-bdcc-940b2695659d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21272, 548, 939, 27, 80, "Input", "ExpressionUUID" -> \
"e0fb0118-29ba-4500-a149-857124aeae07"],
Cell[22214, 577, 1114, 25, 30, "Output", "ExpressionUUID" -> \
"bfeef249-6b2d-43b8-876b-221ccc59f568"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23365, 607, 718, 17, 69, "Input", "ExpressionUUID" -> \
"41c28755-8282-423c-8421-0dfec3fc4464"],
Cell[24086, 626, 3085, 76, 80, "Output", "ExpressionUUID" -> \
"ddc5968d-2bda-4717-8195-a2239e95f60f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27208, 707, 1136, 27, 88, "Input", "ExpressionUUID" -> \
"660f5a4a-2fa1-463b-be4c-f0641f751c98"],
Cell[28347, 736, 1626, 40, 80, "Output", "ExpressionUUID" -> \
"dab35a69-bcbf-43d7-a344-1025761e63a7"],
Cell[29976, 778, 2035, 51, 80, "Output", "ExpressionUUID" -> \
"c3c5b32b-c88c-4778-a41a-293feb5949dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32048, 834, 15417, 334, 558, "Input", "ExpressionUUID" -> \
"abb7e340-0d8d-4c57-b960-a914956b4cac"],
Cell[47468, 1170, 674, 10, 30, "Output", "ExpressionUUID" -> \
"86ae5890-e7ba-4f20-a7e4-7d556e181c8b"],
Cell[48145, 1182, 676, 10, 30, "Output", "ExpressionUUID" -> \
"ec655424-6e7f-4676-9687-08178f29b2fb"],
Cell[48824, 1194, 676, 10, 30, "Output", "ExpressionUUID" -> \
"19effb8d-1f4b-42c0-b120-1608d7405970"],
Cell[49503, 1206, 691, 11, 30, "Output", "ExpressionUUID" -> \
"5cc7a27f-054f-4fb0-886e-a4d6d59ca7e0"],
Cell[50197, 1219, 687, 11, 34, "Output", "ExpressionUUID" -> \
"d1805d7e-8daa-4c7b-b831-65506cdfd21d"],
Cell[50887, 1232, 698, 11, 51, "Output", "ExpressionUUID" -> \
"6a23f6db-25d7-4987-b09c-9bf754572322"],
Cell[51588, 1245, 718, 12, 51, "Output", "ExpressionUUID" -> \
"2df52a9d-14a5-4847-9747-ab7c297ffd71"],
Cell[52309, 1259, 674, 10, 30, "Output", "ExpressionUUID" -> \
"c2f08afc-4b4a-4338-85f4-e88104647cce"]
}, Open  ]],
Cell[52998, 1272, 231, 5, 30, "Input", "ExpressionUUID" -> \
"de7397c3-55a0-43ea-a039-5438d63a3e9b"],
Cell[53232, 1279, 1026, 15, 30, "Input", "ExpressionUUID" -> \
"16b1578a-f42a-4c79-8408-7ac15e6f4f1a"],
Cell[54261, 1296, 429, 7, 30, "Input", "ExpressionUUID" -> \
"3ad6a2d8-f404-4313-8ed4-1dd69b80af03"],
Cell[54693, 1305, 229, 4, 30, "Input", "ExpressionUUID" -> \
"f5ffda9e-8d3b-4e9c-a9bf-20a45ab687e3"],
Cell[54925, 1311, 180, 4, 30, "Input", "ExpressionUUID" -> \
"840c66c4-77e1-445a-a18a-3a54b3b9b6b8"],
Cell[55108, 1317, 128, 3, 30, "Input", "ExpressionUUID" -> \
"518f321a-8092-45c1-ba40-cdf3ec55b92c"],
Cell[55239, 1322, 200, 4, 30, "Input", "ExpressionUUID" -> \
"1642b81b-167d-4604-905a-8288148e24c7"],
Cell[55442, 1328, 125, 2, 30, "Input", "ExpressionUUID" -> \
"f1dc4e6f-48b3-469c-8871-7e819f95eac7"],
Cell[55570, 1332, 201, 4, 30, "Input", "ExpressionUUID" -> \
"f228074e-ca4d-4f07-bfeb-b3680cb010b6"],
Cell[55774, 1338, 940, 13, 30, "Input", "ExpressionUUID" -> \
"7a3665b4-0dd9-4970-b34f-0ffb125a66a2"],
Cell[CellGroupData[{
Cell[56739, 1355, 378, 6, 30, "Input", "ExpressionUUID" -> \
"c9e7d94a-1c77-4174-a9f9-30db71cee6ea"],
Cell[57120, 1363, 1938, 56, 80, "Output", "ExpressionUUID" -> \
"9f19b806-659c-4290-a110-5e0620ff083b"]
}, Open  ]],
Cell[59073, 1422, 576, 9, 30, "Input", "ExpressionUUID" -> \
"318d27d0-526e-46cb-91a1-e71d66f74784"],
Cell[59652, 1433, 281, 5, 63, "Input", "ExpressionUUID" -> \
"8f88fe74-471e-45e4-adb9-d85fe172241f"],
Cell[59936, 1440, 232, 4, 30, "Input", "ExpressionUUID" -> \
"89816be7-6fca-4913-a4e7-461ac3d0af8e"],
Cell[60171, 1446, 2490, 34, 30, "Input", "ExpressionUUID" -> \
"1443f2c2-ee78-40ad-b3f6-52bf7e51f2d9"],
Cell[62664, 1482, 129, 3, 30, "Input", "ExpressionUUID" -> \
"4a320d57-6470-44a9-8b5d-12028b72ad90"],
Cell[62796, 1487, 674, 10, 50, "Input", "ExpressionUUID" -> \
"9fb2a966-04b5-4dbe-9404-e47c25629e41"],
Cell[CellGroupData[{
Cell[63495, 1501, 379, 6, 30, "Input", "ExpressionUUID" -> \
"75c9c6d3-607d-4eb2-bfa2-95f29376c2d9"],
Cell[63877, 1509, 130, 3, 30, "Output", "ExpressionUUID" -> \
"a7fb54f2-074e-4ff6-b497-2b1af8ba09d4"]
}, Open  ]],
Cell[64022, 1515, 227, 4, 30, "Input", "ExpressionUUID" -> \
"26ab2315-0893-46a6-81fb-47b6e14ec5bf"]
}
]
*)

